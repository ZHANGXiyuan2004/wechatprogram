# 零基础操作手册（给不会开发的人）

这份手册只做一件事：
让没有开发经验的人，也能把系统跑起来并做基础排错。

## 1. 先准备什么

只需要 1 个前提：
- 电脑已安装 `Node.js 20+`

如果你不确定：
1. 打开终端。
2. 输入 `node -v` 回车。
3. 如果显示 `v20`、`v21`、`v22` 之类，说明可以继续。

## 2. 你只需要双击这 5 个文件

位置：`scripts/easy`

1. `00-首次安装.command`
2. `01-启动系统.command`
3. `02-停止系统.command`
4. `03-健康检查.command`
5. `04-生成微信小程序包.command`（给微信开发者工具用）

## 3. 第一次使用（只做一次）

1. 双击 `00-首次安装.command`
2. 等待它自动完成（首次可能需要几分钟）
3. 看到“安装完成”即可

如果中途失败：
- 先检查网络是否可用
- 再次双击同一个文件重试

## 4. 每天使用

1. 双击 `01-启动系统.command`
2. 脚本会自动打开浏览器（管理后台 + 小程序预览）
3. 如果浏览器没有自动弹出，再手动复制下面地址访问：
   - 管理后台：<http://127.0.0.1:5174>
   - 小程序预览：<http://127.0.0.1:5173>
   - API文档：<http://127.0.0.1:3000/api/docs>

重要：
- 启动后不要立即关掉电脑
- 可以关闭弹出的脚本窗口，服务会继续运行

## 5. 使用结束

双击 `02-停止系统.command` 即可。

## 5.1 需要微信真机调试时（必须做）

1. 先在 `apps/mini/src/manifest.json` 里填好真实小程序 AppID（不能是 `wx-demo-appid`）
2. 双击 `04-生成微信小程序包.command`
3. 按脚本输出的目录去微信开发者工具里“导入项目”
4. 如果目录名是 `mp-weixin-wrapper`，先双击 `01-启动系统.command`，再在开发者工具点“打开训练页面”

详细图文步骤见：
`docs/wechat-devtools-guide.md`

## 6. 出现问题怎么办

先双击 `03-健康检查.command`。

它会告诉你：
- Node 是否正常
- 三个服务是否在运行
- 三个地址是否可访问
- 日志文件在哪里

日志目录：`.run/logs`

常看这 3 个日志：
- `.run/logs/api.log`
- `.run/logs/admin-web.log`
- `.run/logs/mini-web.log`

### 6.1 如果只有 API 失败（前端能开，接口打不开）

按顺序做：
1. 双击 `02-停止系统.command`
2. 双击 `00-首次安装.command`
3. 再双击 `01-启动系统.command`

如果还不行，把 `.run/logs/api.log` 发给技术同事。

### 6.2 如果提示网络错误（ENOTFOUND / ECONNRESET）

这通常是网络问题，不是代码问题。

处理方式：
1. 切换网络（比如手机热点）后重试
2. 或稍后再试（npm 源偶发波动）
3. 公司网络需代理时，请先配置代理再运行脚本

### 6.3 如果“小程序预览网页打不开/看起来空白”

按顺序做：
1. 先双击 `03-健康检查.command`，确认“小程序预览”为`通过`
2. 如果是`通过`，手动在浏览器输入：`http://127.0.0.1:5173`
3. 如果打开后只看到引导页，这是正常现象（本地预览入口页）
4. 如果仍打不开，执行：
   - 双击 `02-停止系统.command`
   - 双击 `01-启动系统.command`
5. 还不行就把 `.run/logs/mini-web.log` 发给技术同事

## 7. 给技术同事的最小排错信息

出问题时，请把下面信息发给技术同事：
1. `03-健康检查.command` 的完整截图
2. 对应日志最后 50 行
3. 你刚才做了什么操作（例如“刚点了启动，访问 5174 白屏”）

## 8. 不建议做的事

- 不要手改 `package.json`、`tsconfig`、`vite.config` 等配置文件
- 不要随便删除 `.run` 以外的目录
- 不要同时开多个“启动脚本”窗口

## 9. 维护人员快速命令（可选）

```bash
COREPACK_HOME=/tmp/corepack corepack pnpm -r build
COREPACK_HOME=/tmp/corepack corepack pnpm -r test
```
